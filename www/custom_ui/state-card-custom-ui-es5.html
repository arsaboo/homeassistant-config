<div hidden="" by-polymer-bundler=""><script>window.customUI=window.customUI||{SUPPORTED_SLIDER_MODES:["single-line","break-slider","break-slider-toggle","hide-slider","no-slider"],domHost:function(t){if(t===document)return null;var e=t.getRootNode();return e instanceof DocumentFragment?e.host:e},lightOrShadow:function(t,e){return t.shadowRoot?t.shadowRoot.querySelector(e):t.querySelector(e)},getElementHierarchy:function(t,e){if(null===t)return null;var i=e.shift();return i?window.customUI.getElementHierarchy(window.customUI.lightOrShadow(t,i),e):t},getContext:function(t){if(void 0===t._context){t._context=[];for(var e="HA-ENTITIES-CARD"===t.tagName?window.customUI.domHost(t):t;e;e=window.customUI.domHost(e))switch(e.tagName){case"HA-ENTITIES-CARD":e.groupEntity?t._context.push(e.groupEntity.entity_id):!1===e.groupEntity&&e.states&&e.states.length&&t._context.push("group."+window.hassUtil.computeDomain(e.states[0]));break;case"MORE-INFO-GROUP":case"STATE-CARD-CONTENT":e.stateObj&&t._context.push(e.stateObj.entity_id);break;case"HA-CARDS":t._context.push(e.getAttribute("data-view")||"default_view")}t._context.reverse()}return t._context},findMatch:function(t,e){return e?e[t]?t:Object.keys(e).find(function(e){return t.match("^"+e+"$")}):null},maybeChangeObjectByDevice:function(t){var e=window.customUI.getName();if(!e)return t;var i=this.findMatch(e,t.attributes.device);if(!i)return t;var a=Object.assign({},t.attributes.device[i]);return Object.keys(a).length?window.customUI.applyAttributes(t,a):t},maybeChangeObjectByGroup:function(t,e){var i=this,a=window.customUI.getContext(t);if(!a)return e;if(!e.attributes.group)return e;var s={};return a.forEach(function(t){var a=i.findMatch(t,e.attributes.group);e.attributes.group[a]&&Object.assign(s,e.attributes.group[a])}),Object.keys(s).length?window.customUI.applyAttributes(e,s):e},_setKeep:function(t,e){void 0===t._cui_keep?t._cui_keep=e:t._cui_keep=t._cui_keep&&e},maybeApplyTemplateAttributes:function(t,e,i,a){if(!a.templates)return window.customUI._setKeep(i,!0),i;var s={},o=!1,n=!1;if(Object.keys(a.templates).forEach(function(r){var u=a.templates[r];u.match(/\b(entities|hass)\b/)&&(o=!0);var c=window.customUI.computeTemplate(u,t,e,i,a,i.untemplated_attributes&&i.untemplated_attributes[r]||a[r],i.untemplated_state||i.state);null!==c&&(s[r]=c,"state"===r?c!==i.state&&(n=!0):"_stateDisplay"===r?c!==i._stateDisplay&&(n=!0):c!==a[r]&&(n=!0))}),window.customUI._setKeep(i,!o),!n)return i;if(i.attributes===a){var r=window.customUI.applyAttributes(i,s);return Object.prototype.hasOwnProperty.call(s,"state")&&null!==s.state&&(r.state=String(s.state),r.untemplated_state=i.state),Object.prototype.hasOwnProperty.call(s,"_stateDisplay")&&(r._stateDisplay=s._stateDisplay,r.untemplated_stateDisplay=i._stateDisplay),window.customUI._setKeep(r,!o),r}return Object.assign({},i)},maybeApplyTemplates:function(t,e,i){var a=window.customUI.maybeApplyTemplateAttributes(t,e,i,i.attributes),s=a!==i;function o(i){i&&(Object.values(i).forEach(function(i){var o=window.customUI.maybeApplyTemplateAttributes(t,e,a,i);s|=o!==a}),o(i.device),o(i.group))}return o(i.attributes.device),o(i.attributes.group),a!==i?a:s?Object.assign({},i):i},applyAttributes:function(t,e){return{entity_id:t.entity_id,state:t.state,attributes:Object.assign({},t.attributes,e),untemplated_attributes:t.attributes,last_changed:t.last_changed}},maybeChangeObject:function(t,e,i,a){if(i)return e;var s=window.customUI.maybeChangeObjectByDevice(e);return s=window.customUI.maybeChangeObjectByGroup(t,s),(s=window.customUI.maybeApplyTemplateAttributes(t.hass,t.hass.states,s,s.attributes))!==e&&s.attributes.hidden&&a?null:s},fixGroupTitles:function(){var t=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main"]);if(null!==t){var e=window.customUI.getElementHierarchy(t,["partial-cards","ha-cards[view-visible]"]);if(null!==e)(window.customUI.lightOrShadow(e,".main")||e.$.main).querySelectorAll("ha-entities-card").forEach(function(t){if(t.groupEntity){var e=window.customUI.maybeChangeObject(t,t.groupEntity,!1,!1);if(e!==t.groupEntity&&e.attributes.friendly_name)window.customUI.lightOrShadow(t,".name").textContent=e.attributes.friendly_name}})}else window.setTimeout(window.customUI.fixGroupTitles,1e3)},showVersion:function(){if("/dev-info"===window.location.pathname){var t=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main","partial-panel-resolver","ha-panel-dev-info"]);if(null!==t){if(!(t.hass&&t.hass.config&&t.hass.config.core&&t.hass.config.core.version&&t.hass.config.core.version.split(".")[1]>65)){var e=window.customUI.lightOrShadow(t,".about"),i=e.querySelectorAll("p")[1],a=document.createElement("p");a.textContent="Custom UI "+window.customUI.VERSION,e.insertBefore(a,i)}}else window.setTimeout(window.customUI.showVersion,1e3)}},controlColumns:function(t){var e=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main","partial-cards"]);null!==e?(e.mqls.forEach(function(t){t.removeListener(e.handleWindowChange)}),e.mqls=t.map(function(t){var i=window.matchMedia("(min-width: "+t+"px)");return i.addListener(e.handleWindowChange),i}),e.handleWindowChange()):window.setTimeout(window.customUI.controlColumns.bind(null,t),1e3)},useCustomizer:function(){var t=window.customUI.lightOrShadow(document,"home-assistant").hass.states["customizer.customizer"];t&&(t.attributes.columns&&window.customUI.controlColumns(t.attributes.columns),t.attributes.hide_attributes&&(window.hassUtil.LOGIC_STATE_ATTRIBUTES&&Array.prototype.push.apply(window.hassUtil.LOGIC_STATE_ATTRIBUTES,t.attributes.hide_attributes),window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES&&t.attributes.hide_attributes.forEach(function(t){Object.prototype.hasOwnProperty.call(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES,t)||(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES[t]=void 0)})))},updateAttributes:function(){var t={group:void 0,device:void 0,templates:void 0,state_card_mode:{type:"array",options:{light:window.customUI.SUPPORTED_SLIDER_MODES.concat("badges"),cover:window.customUI.SUPPORTED_SLIDER_MODES.concat("badges"),"*":["badges"]}},state_card_custom_ui_secondary:{type:"string"},badges_list:{type:"json"},show_last_changed:{type:"boolean"},hide_control:{type:"boolean"},extra_data_template:{type:"string"},extra_badge:{type:"json"},stretch_slider:{type:"boolean"},slider_theme:{type:"json"},theme:{type:"string"},confirm_controls:{type:"boolean"},confirm_controls_show_lock:{type:"boolean"},hide_in_default_view:{type:"boolean"}};window.hassUtil.LOGIC_STATE_ATTRIBUTES&&Array.prototype.push.apply(window.hassUtil.LOGIC_STATE_ATTRIBUTES,Object.keys(t)),window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES&&Object.assign(window.hassAttributeUtil.LOGIC_STATE_ATTRIBUTES,t)},updateConfigPanel:function(){if(window.location.pathname.startsWith("/config")){var t=window.customUI.getElementHierarchy(document,["home-assistant","home-assistant-main","partial-panel-resolver","ha-panel-config"]);if(t){var e=window.customUI.getElementHierarchy(t,["ha-config-dashboard","ha-config-navigation"]);e&&(e.localize&&!e.cuiPatch&&(e.cuiPatch=!0,e._originalComputeLoaded=e._computeLoaded,e._originalComputeCaption=e._computeCaption,e._originalComputeDescription=e._computeDescription,e._computeLoaded=function(t,i){return"customui"===i||e._originalComputeLoaded(t,i)},e._computeCaption=function(t,i){return"customui"===t?"Custom UI":e._originalComputeCaption(t,i)},e._computeDescription=function(t,i){return"customui"===t?"SetUI tweaks":e._originalComputeDescription(t,i)}),e.pages.some(function(t){return"customui"===t||"customui"===t.domain})||e.push("pages",e.localize?"customui":{domain:"customui",caption:"Custom UI",description:"Set UI tweaks.",loaded:!0}));var i=function(){var e=document.createElement("ha-config-custom-ui");return e.isWide=t.isWide,e.setAttribute("page-name","customui"),e},a=window.customUI.lightOrShadow(t,"iron-pages");if(a){if("HA-CONFIG-CUSTOM-UI"!==a.lastElementChild.tagName){var s=i();a.appendChild(s),a.addEventListener("iron-items-changed",function(){window.location.pathname.startsWith("/config/customui")&&a.select("customui")})}}else{var o=t.shadowRoot||t;if("HA-CONFIG-CUSTOM-UI"!==o.lastElementChild.tagName){var n=i();o.appendChild(n)}var r=window.location.pathname.startsWith("/config/customui");o.lastElementChild.style.display=r?"":"none"}}else window.setTimeout(window.customUI.updateConfigPanel,100)}},installStatesHook:function(){var t=customElements.get("home-assistant");if(t&&t.prototype._updateHass){var e=t.prototype._updateHass;t.prototype._updateHass=function(t){var i=this.hass;t.states&&Object.keys(t.states).forEach(function(e){var a=t.states[e];if(!a._cui_keep){var s=window.customUI.maybeApplyTemplates(i,t.states,a);i.states&&a!==i.states[e]?t.states[e]=s:a!==s&&(t.states[e]=s)}}),e.call(this,t),t.themes&&i._themeWaiters&&(i._themeWaiters.forEach(function(t){return t.stateChanged(t.state)}),i._themeWaiters=void 0)};var i=window.customUI.lightOrShadow(document,"home-assistant");i.hass&&i.hass.states&&i._updateHass({states:i.hass.states})}},installPartialCards:function(){var t=customElements.get("partial-cards");t&&t.prototype._defaultViewFilter&&(t.prototype._defaultViewFilter=function(t,e){if(t.states[e].attributes.hidden)return!1;var i={};return Object.values(t.states).forEach(function(e){if(e.attributes&&e.attributes.hide_in_default_view){var a=e.entity_id;if(i[a])return;i[a]=e,e.attributes.view&&Object.assign(i,window.HAWS.getViewEntities(t.states,e))}}),!i[e]})},installActionName:function(t){var e=customElements.get(t);e&&e.prototype&&Object.defineProperty(e.prototype,"localize",{get:function(){return function(t){return this.stateObj&&this.stateObj.attributes&&this.stateObj.attributes.action_name?this.stateObj.attributes.action_name:this.__data.localize(t)}},set:function(){}})},installHaStateLabelBadge:function(){var t=customElements.get("ha-state-label-badge");t&&t.prototype.stateChanged&&(t.prototype.stateChanged=function(t){t.attributes.theme&&(null===this.hass.themes?(this.hass._themeWaiters=this.hass._themeWaiters||[],this.hass._themeWaiters.push(this)):window.hassUtil.applyThemesOnElement(this,this.hass.themes||{default_theme:"default",themes:{}},t.attributes.theme||"default")),this.updateStyles(),this.startInterval&&this.startInterval(t)})},installStateBadge:function(){var t=customElements.get("state-badge");if(t&&t.prototype.updateIconAppearance){var e=t.prototype.updateIconAppearance;t.prototype.updateIconAppearance=function(t){t.attributes.icon_color&&!t.attributes.entity_picture?(this.style.backgroundImage="",Object.assign(this.$.icon.style,{display:"inline",color:t.attributes.icon_color,filter:""})):e.call(this,t)}}},installClassHooks:function(){window.customUI.classInitDone||(window.customUI.classInitDone=!0,window.customUI.installPartialCards(),window.customUI.installStatesHook(),window.customUI.installHaStateLabelBadge(),window.customUI.installStateBadge(),window.customUI.installActionName("state-card-scene"),window.customUI.installActionName("state-card-script"))},init:function(){if(!window.customUI.initDone){window.customUI.installClassHooks();var t=window.customUI.lightOrShadow(document,"home-assistant");t.hass&&t.hass.states?(window.customUI.initDone=!0,window.customUI.useCustomizer(),window.customUI.runHooks(),window.addEventListener("location-changed",window.setTimeout.bind(null,window.customUI.runHooks,100)),console.log("Loaded CustomUI "+window.customUI.VERSION),window.CUSTOM_UI_LIST||(window.CUSTOM_UI_LIST=[]),window.CUSTOM_UI_LIST.push({name:"CustomUI",version:window.customUI.VERSION,url:"https://github.com/andrey-git/home-assistant-custom-ui"})):window.setTimeout(window.customUI.init,1e3)}},runHooks:function(){window.customUI.fixGroupTitles(),window.customUI.showVersion(),window.customUI.updateAttributes(),window.customUI.updateConfigPanel()},getName:function(){return window.localStorage.getItem("ha-device-name")||""},setName:function(t){window.localStorage.setItem("ha-device-name",t||"")},computeTemplate:function(t,e,i,a,s,o,n){var r=t.indexOf("return")>=0?t:"return `"+t+"`;";try{return new Function("hass","entities","entity","attributes","attribute","state",r)(e,i,a,s,o,n)}catch(t){if(t instanceof SyntaxError||t instanceof ReferenceError)return console.warn(t.name+": "+t.message+" in template "+r),null;throw t}}};</script><script>window.customUI.VERSION="20180429";</script><script>window.customUI.init();</script><dom-module id="ha-config-custom-ui"><template><style include="ha-style"></style><app-header-layout has-scrolling-region=""><app-header slot="header" fixed=""><app-toolbar><paper-icon-button icon="mdi:arrow-left" on-click="_backHandler"></paper-icon-button><div main-title="">Custom UI settings</div></app-toolbar></app-header><ha-config-section is-wide="[[isWide]]"><paper-card heading="Device name"><div class="card-content">Set device name so that you can reference it in per-device settings<paper-input label="Name" value="{{name}}"></paper-input></div></paper-card></ha-config-section></app-header-layout></template></dom-module><script>var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var HaConfigCustomUi=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,window.hassMixins.EventsMixin(Polymer.Element)),_createClass(t,[{key:"ready",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ready",this).call(this),this.name=window.customUI.getName()}},{key:"nameChanged",value:function(e){window.customUI.setName(e)}},{key:"_backHandler",value:function(){window.history.back(),this.fire("location-changed")}}],[{key:"is",get:function(){return"ha-config-custom-ui"}},{key:"properties",get:function(){return{isWide:Boolean,name:{type:String,observer:"nameChanged"}}}}]),t}();customElements.define(HaConfigCustomUi.is,HaConfigCustomUi);</script><script>var _createClass=function(){function t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,r,n){return r&&t(e.prototype,r),n&&t(e,n),e}}();function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var CuiBaseElement=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,Polymer.Element),_createClass(e,[{key:"computeExtra",value:function(t,e){var r=e.attributes.extra_data_template;return r?(Array.isArray(r)||(r=[r]),r.map(function(r){return window.customUI.computeTemplate(r,t,t.states,e,e.attributes,void 0,e.state)}).filter(function(t){return null!==t})):[]}},{key:"showLastChanged",value:function(t,e,r){return!!e||!r.length&&!!t.attributes.show_last_changed}},{key:"hasExtra",value:function(t){return t.length>0}}],[{key:"properties",get:function(){return{hass:Object,inDialog:{type:Boolean,value:!1},stateObj:Object,controlElement:String,extra:{type:Array,computed:"computeExtra(hass, stateObj)"}}}}]),e}();</script><script>var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var DynamicElement=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,Polymer.Element),_createClass(t,[{key:"observerFunc",value:function(e,t,n,r){window.hassUtil.dynamicContentUpdater(this,n?n.toUpperCase():"DIV",{hass:e,stateObj:t,inDialog:r})}}],[{key:"is",get:function(){return"dynamic-element"}},{key:"properties",get:function(){return{hass:Object,stateObj:Object,elementName:String,inDialog:{type:Boolean,value:!1}}}},{key:"observers",get:function(){return["observerFunc(hass, stateObj, elementName, inDialog)"]}}]),t}();customElements.define(DynamicElement.is,DynamicElement);</script><dom-module id="dynamic-with-extra"><template><style is="custom-style" include="iron-flex iron-flex-alignment iron-flex-factors"></style><style>:host{display:inline-block}.control-wrapper{margin:-4px -16px -4px 0;padding:4px 16px}ha-state-label-badge{margin-left:8px}dynamic-element{display:block;text-align:right}#overlay{position:absolute;left:0;right:0;top:0;bottom:0;text-align:right;z-index:1}#lock{margin-top:8px;opacity:.3;margin-right:7px}#lock.ha-cover-controls{margin-right:52px;background-color:#fff}.extra{margin-bottom:-16px;--ha-label-badge-size:36px;--ha-label-badge-font-size:1.2em}.state{@apply(--paper-font-body1);color:var(--primary-text-color);margin-left:16px;text-align:right;line-height:40px}</style><div class$="[[extraClass(extraObjVisible)]] horizontal layout"><template is="dom-if" if="[[extraObjVisible]]"><template is="dom-repeat" items="[[extraObj]]" on-dom-change="extraDomChanged"><ha-state-label-badge hass="[[hass]]" state="[[item]]"></ha-state-label-badge></template></template><template is="dom-if" if="[[_showControl(inDialog, stateObj)]]"><template is="dom-if" if="[[controlElement]]"><div class="control-wrapper"><dynamic-element class="flex" state-obj="[[stateObj]]" hass="[[hass]]" element-name="[[controlElement]]"></dynamic-element><template is="dom-if" if="[[isConfirmControls(stateObj)]]"><div id="overlay" on-click="clickHandler"><template is="dom-if" if="[[stateObj.attributes.confirm_controls_show_lock]]"><iron-icon id="lock" class$="[[controlElement]]" icon="mdi:lock-outline"></iron-icon></template></div></template></div></template><template is="dom-if" if="[[!controlElement]]"><div class="state">[[computeStateDisplay(stateObj)]]</div></template></template></div></template></dom-module><script>var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}return function(e,n,o){return n&&t(e.prototype,n),o&&t(e,o),e}}(),_get=function t(e,n,o){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,n);if(void 0===r){var a=Object.getPrototypeOf(e);return null===a?void 0:t(a,n,o)}if("value"in r)return r.value;var i=r.get;return void 0!==i?i.call(o):void 0};function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var DynamicWithExtra=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,StateCardDisplay||Polymer.Element),_createClass(e,[{key:"connectedCallback",value:function(){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"connectedCallback",this).call(this),this._attached=!0}},{key:"disconnectedCallback",value:function(){this._isAttached=!1,_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disconnectedCallback",this).call(this)}},{key:"computeExtra",value:function(t,e,n){var o=this;if(!e.attributes.extra_badge||!n)return[];var r=e.attributes.extra_badge;return Array.isArray(r)||(r=[r]),r.map(function(n){var r=null;if(n.entity_id&&t.states[n.entity_id]?r=Object.assign({},window.customUI.maybeChangeObject(o,t.states[n.entity_id],o.inDialog,!1)):n.attribute&&void 0!==e.attributes[n.attribute]&&(r={state:String(e.attributes[n.attribute]),_domain:"none",entity_id:null,attributes:{unit_of_measurement:n.unit}}),!r)return null;var a=n.blacklist_states;return void 0!==a&&(Array.isArray(a)||(a=[a]),a.some(function(t){return RegExp(t).test(r.state.toString())}))?null:(r._entityDisplay="",r)}).filter(function(t){return null!=t})}},{key:"computeExtraVisible",value:function(t,e){return!(e||!t)&&0!==t.length}},{key:"extraClass",value:function(t){return t?"extra":""}},{key:"_showControl",value:function(t,e){return!!t||!e.attributes.hide_control}},{key:"computeStateDisplay",value:function(t){return window.hassUtil.computeStateState?window.hassUtil.computeStateState(t):_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"computeStateDisplay",this).call(this,this.haLocalize||this.localize,t)}},{key:"isConfirmControls",value:function(t){return t.attributes.confirm_controls||t.attributes.confirm_controls_show_lock}},{key:"clickHandler",value:function(t){var e=this;this.$$("#overlay").style.pointerEvents="none";var n=this.$$("#lock");n&&(n.icon="mdi:lock-open-outline",n.style.opacity="0.1"),window.setTimeout(function(){e.$$("#overlay").style.pointerEvents="",n&&(n.icon="mdi:lock-outline",n.style.opacity="")},5e3),t.stopPropagation()}},{key:"applyThemes",value:function(t,e,n){var o=n.attributes.theme||"default";window.hassUtil.applyThemesOnElement(e,t.themes||{default_theme:"default",themes:{}},o)}},{key:"extraDomChanged",value:function(){var t=this;this.root.querySelectorAll("ha-state-label-badge").forEach(function(e){t.applyThemes(t.hass,e,e.state)})}}],[{key:"is",get:function(){return"dynamic-with-extra"}},{key:"properties",get:function(){return{hass:Object,inDialog:{type:Boolean,value:!1},stateObj:Object,controlElement:String,extraObj:{type:Array,computed:"computeExtra(hass, stateObj, _attached)"},_attached:Boolean,extraObjVisible:{type:Boolean,computed:"computeExtraVisible(extraObj, inDialog)"}}}}]),e}();customElements.define(DynamicWithExtra.is,DynamicWithExtra);</script><dom-module id="ha-themed-slider"><template><style>:host{margin:var(--ha-themed-slider-margin,initial)}.disable-off-when-min{--paper-slider-pin-start-color:var(--paper-slider-pin-color)}.disable-off-when-min.is-on{--paper-slider-knob-start-color:var(--paper-slider-knob-color);--paper-slider-knob-start-border-color:var(--paper-slider-knob-color)}paper-slider{margin:4px 0;max-width:100%;min-width:100px;width:var(--ha-paper-slider-width,200px)}</style><paper-slider min="[[_themedMin]]" max="[[_computeAttribute(theme, &quot;max&quot;, max)]]" pin="[[_computeAttribute(theme, &quot;pin&quot;, pin)]]" class$="[[computeClass(theme, isOn, _themedMin)]]" value="[[value]]" on-change="valueChanged"></paper-slider></template></dom-module><script>var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_get=function e(t,n,o){null===t&&(t=Function.prototype);var r=Object.getOwnPropertyDescriptor(t,n);if(void 0===r){var i=Object.getPrototypeOf(t);return null===i?void 0:e(i,n,o)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(o):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var HaThemedSlider=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,Polymer.Element),_createClass(t,[{key:"ready",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ready",this).call(this),this.disableOffWhenMin=!this._computeAttribute(this.theme,"off_when_min",!this.disableOffWhenMin),this.computeEnabledThemedReportWhenNotChanged(this.theme,this.disableReportWhenNotChanged)}},{key:"computeEnabledThemedReportWhenNotChanged",value:function(e,t){this._enabledThemedReportWhenNotChanged=this._computeAttribute(e,"report_when_not_changed",!t)}},{key:"_computeAttribute",value:function(e,t,n){return e&&t in e?e[t]:n}},{key:"computeClass",value:function(e,t,n){var o="";return t&&(o+="is-on "),this._computeAttribute(e,"off_when_min",!this.disableOffWhenMin)||0===n?"":o+"disable-off-when-min"}},{key:"valueChanged",value:function(e){this._enabledThemedReportWhenNotChanged||this.value!==e.target.value?this.value=e.target.value:e.stopPropagation()}}],[{key:"is",get:function(){return"ha-themed-slider"}},{key:"properties",get:function(){return{min:{type:Number,value:0},max:{type:Number,value:100},pin:{type:Boolean,value:!1},isOn:{type:Boolean,value:!1},disableOffWhenMin:{type:Boolean,value:!1,notify:!0},disableReportWhenNotChanged:{type:Boolean,value:!1},theme:Object,value:{type:Number,notify:!0},_themedMin:{type:Number,computed:'_computeAttribute(theme, "min", min)'}}}},{key:"observers",get:function(){return["computeEnabledThemedReportWhenNotChanged(theme, disableReportWhenNotChanged)"]}}]),t}();customElements.define(HaThemedSlider.is,HaThemedSlider);</script><dom-module id="state-card-with-slider"><template><style is="custom-style" include="iron-flex iron-flex-alignment iron-flex-factors"></style><style>#container{position:relative}.second-line,.state-and-toggle,.state-info{max-width:100%}.nowrap .state-and-toggle{overflow:hidden;flex-grow:0}.nowrap .second-line{overflow:hidden}.second-line{padding-top:20px;padding-bottom:16px;margin-top:-20px;margin-bottom:-16px}.stretch .second-line,.stretch ha-themed-slider{width:100%;--ha-paper-slider-width:100%}.nowrap .state-info{min-width:initial}.top-wrapper,ha-themed-slider{min-width:100px;max-width:100%}.top-wrapper.stretch{display:block}.hidden{display:none}</style><div id="container" class$="horizontal layout flex top-wrapper [[_computeWrapClass(mode, stretchSlider, lineTooLong, inDialog)]]"><div class="horizontal layout justified flex-auto state-and-toggle"><state-info class="state-info" state-obj="[[stateObj]]" in-dialog="[[showLastChanged(stateObj, inDialog, extra)]]" secondary-line$="[[hasExtra(extra)]]"><template is="dom-repeat" items="[[extra]]"><div>[[item]]</div></template></state-info><template is="dom-if" if="[[breakSlider]]" class="hidden"><dynamic-with-extra hass="[[hass]]" state-obj="[[stateObj]]" control-element="[[controlElement]]" in-dialog="[[inDialog]]"></dynamic-with-extra></template></div><template is="dom-if" if="[[showSlider]]" restamp=""><div class="horizontal layout flex-auto end-justified second-line"><ha-themed-slider id="slider" max="[[max]]" min="[[min]]" theme="[[stateObj.attributes.slider_theme]]" is-on="[[isOn(stateObj, nameOn)]]" value="{{sliderValue}}" disable-off-when-min="{{disableOffWhenMin}}" on-change="sliderChanged" on-click="stopPropagation"></ha-themed-slider><template is="dom-if" if="[[!breakSlider]]"><dynamic-with-extra hass="[[hass]]" state-obj="[[stateObj]]" control-element="[[controlElement]]" in-dialog="[[inDialog]]"></dynamic-with-extra></template></div></template></div></template></dom-module><script>var _slicedToArray=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var i=[],r=!0,n=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(i.push(a.value),!t||i.length!==t);r=!0);}catch(e){n=!0,o=e}finally{try{!r&&s.return&&s.return()}finally{if(n)throw o}}return i}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),_createClass=function(){function e(e,t){for(var i=0;i<t.length;i++){var r=t[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,i,r){return i&&e(t.prototype,i),r&&e(t,r),t}}(),_get=function e(t,i,r){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,i);if(void 0===n){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,i,r)}if("value"in n)return n.value;var a=n.get;return void 0!==a?a.call(r):void 0};function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var StateCardWithSlider=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,Polymer.mixinBehaviors([Polymer.IronResizableBehavior],CuiBaseElement)),_createClass(t,[{key:"ready",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"ready",this).call(this),this._onIronResize=this._onIronResize.bind(this)}},{key:"connectedCallback",value:function(){_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"connectedCallback",this).call(this),this.addEventListener("iron-resize",this._onIronResize),this._waitForLayout()}},{key:"disconnectedCallback",value:function(){this.removeEventListener("iron-resize",this._onIronResize),_get(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"disconnectedCallback",this).call(this)}},{key:"_waitForLayout",value:function(){var e=this;this._setMode(),this._frameId||(this.readyToCompute=!1,this._frameId=window.requestAnimationFrame(function(){e._frameId=null,e.readyToCompute=!0,e._onIronResize()}))}},{key:"_setMode",value:function(){var e={hideSlider:"hide-slider"===this.mode&&this.lineTooLong,breakSlider:("break-slider"===this.mode||"hide-slider"===this.mode)&&this.lineTooLong};this.showSlider||(e.breakSlider=!0),this.setProperties(e)}},{key:"_onIronResize",value:function(){if(this.readyToCompute)if("no-slider"!==this.mode){var e=this.breakSlider,t=this.hideSlider;this.setProperties({lineTooLong:!1,hideSlider:!1,breakSlider:!1});var i=this.$.container,r=i.clientWidth;if(0!==r){if(r<=this.minLineBreak)this.lineTooLong=!0;else if(r>=this.maxLineBreak)this.lineTooLong=!1;else{if(t&&"hide-slider"===this.mode)return void this._waitForLayout();var n=i.clientHeight,o=this.$$(".state-info").clientHeight;this.lineTooLong=n>1.5*o,this.lineTooLong?this.minLineBreak=r:e||(this.maxLineBreak=r)}this._setMode()}}else this.setProperties({hideSlider:!0,breakSlider:!0})}},{key:"_computeWrapClass",value:function(e,t,i,r){return r?"":"single-line"===e?"nowrap":t&&i?"stretch wrap":"wrap"}},{key:"_showSlider",value:function(e,t,i){return!e&&!i}},{key:"sliderChanged",value:function(e){var t=parseInt(e.target.value,10),i={entity_id:this.stateObj.entity_id};if(!Number.isNaN(t)){var r=this.$$("#slider");if(e.target!==r)r=e.target;else if(e.path){r=_slicedToArray(e.path,1)[0]}else if(e.composedPath){var n=e.composedPath();r=_slicedToArray(n,1)[0]}0===t||t<=r.min&&!this.disableOffWhenMin?this.hass.callService(this.domain,this.serviceMin,i):(i[this.setValueName||this.valueName]=t,this.hass.callService(this.domain,this.serviceMax,i))}}},{key:"stateObjChanged",value:function(e,t,i){var r={sliderValue:this.isOn(e,t)?e.attributes[i]:0};e&&Object.assign(r,{minLineBreak:0,maxLineBreak:999,hideSlider:!1,breakSlider:!1,lineTooLong:!1,mode:e.attributes.state_card_mode,stretchSlider:!!e.attributes.stretch_slider}),this.setProperties(r),e&&this._waitForLayout()}},{key:"isOn",value:function(e,t){return e&&(!t||e.state===t)}},{key:"stopPropagation",value:function(e){e.stopPropagation()}}],[{key:"is",get:function(){return"state-card-with-slider"}},{key:"properties",get:function(){return{domain:String,serviceMin:String,serviceMax:String,valueName:String,setValueName:String,nameOn:{type:String,value:"on"},min:{type:Number,value:0},max:{type:Number,value:255},sliderValue:{type:Number,value:0},disableOffWhenMin:Boolean,mode:String,stretchSlider:{type:Boolean,value:!1},breakSlider:{type:Boolean,value:!1},hideSlider:{type:Boolean,value:!1},lineTooLong:{type:Boolean,value:!1},minLineBreak:Number,maxLineBreak:Number,showSlider:{type:Number,computed:"_showSlider(inDialog, stateObj, hideSlider)"}}}},{key:"observers",get:function(){return["stateObjChanged(stateObj, nameOn, valueName)"]}}]),t}();customElements.define(StateCardWithSlider.is,StateCardWithSlider);</script><dom-module id="state-card-without-slider"><template><style is="custom-style" include="iron-flex iron-flex-alignment"></style><style>#container{position:relative}</style><div id="container" class="horizontal layout justified"><state-info class="state-info" state-obj="[[stateObj]]" in-dialog="[[showLastChanged(stateObj, inDialog, extra)]]" secondary-line$="[[hasExtra(extra)]]"><template is="dom-repeat" items="[[extra]]"><div>[[item]]</div></template></state-info><dynamic-with-extra hass="[[hass]]" state-obj="[[stateObj]]" control-element="[[controlElement]]" in-dialog="[[inDialog]]"></dynamic-with-extra></div></template></dom-module><script>var _createClass=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var StateCardWithoutSlider=function(e){function t(){return _classCallCheck(this,t),_possibleConstructorReturn(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return _inherits(t,CuiBaseElement),_createClass(t,null,[{key:"is",get:function(){return"state-card-without-slider"}}]),t}();customElements.define(StateCardWithoutSlider.is,StateCardWithoutSlider);</script><script>var _createClass=function(){function t(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}return function(e,i,a){return i&&t(e.prototype,i),a&&t(e,a),e}}(),_get=function t(e,i,a){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,i);if(void 0===n){var s=Object.getPrototypeOf(e);return null===s?void 0:t(s,i,a)}if("value"in n)return n.value;var r=n.get;return void 0!==r?r.call(a):void 0};function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _possibleConstructorReturn(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function _inherits(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var SHOW_LAST_CHANGED_BLACKLISTED_CARDS=["configurator"],DOMAIN_TO_SLIDER_SUPPORT={light:1,cover:4,climate:1},TYPE_TO_CONTROL={toggle:"ha-entity-toggle",display:"",cover:"ha-cover-controls"},StateCardCustomUi=function(t){function e(){return _classCallCheck(this,e),_possibleConstructorReturn(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return _inherits(e,Polymer.Element),_createClass(e,[{key:"connectedCallback",value:function(){_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"connectedCallback",this).call(this);var t=this.parentNode.parentNode;"DIV"===t.tagName&&(t.classList.contains("state")||t.classList.contains("child-card"))&&(this._container=t,t.style.setProperty("background-color","var(--paper-card-background-color, inherit)"),t.updateStyles||(t.updateStyles=function(e){Object.keys(e).forEach(function(i){t.style.setProperty(i,e[i])})})),this._isAttached=!0,this.inputChanged(this.hass,this.inDialog,this.stateObj)}},{key:"disconnectedCallback",value:function(){this._isAttached=!1,this._container&&(this._container.updateStyles({display:"",margin:"",padding:""}),window.hassUtil.applyThemesOnElement(this._container,this.hass.themes||{default_theme:"default",themes:{}},"default"),this._container=null),_get(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"disconnectedCallback",this).call(this)}},{key:"badgeMode",value:function(t,e,i){var a=this,n=[];if("group"===i)e.attributes.entity_id.forEach(function(i){var s=t.states[i];s?e.attributes.badges_list&&!e.attributes.badges_list.includes(s.entity_id)||n.push(window.customUI.maybeChangeObject(a,s,!1,!1)):console.warn("Unknown ID "+i+" in group "+e.entity_id)});else if(n.push(e),this._container){this._container.style.display="inline-block";var s={display:"inline-block"};this._container.classList.contains("state")&&(s.margin="var(--ha-badges-card-margin, 0)"),this.updateStyles(s)}window.hassUtil.dynamicContentUpdater(this,"HA-BADGES-CARD",{hass:t,states:n}),this._container&&this._container.updateStyles({width:"var(--ha-badges-card-width, initial)","text-align":"var(--ha-badges-card-text-align, initial)"}),this.lastChild.style.fontSize="85%",this.style.setProperty("--ha-state-label-badge-margin-bottom","0")}},{key:"cleanBadgeStyle",value:function(){this._container&&this._container.updateStyles({display:"",width:"","text-align":""}),this.updateStyles({display:"",margin:""})}},{key:"applyThemes",value:function(t,e){var i=this,a="default";this._container&&(i=this._container),e.attributes.theme&&(a=e.attributes.theme),window.hassUtil.applyThemesOnElement(i,t.themes||{default_theme:"default",themes:{}},a)}},{key:"maybeHideEntity",value:function(t){return t?(this._container&&this._container.updateStyles({margin:"",padding:""}),!1):(this.lastChild&&this.removeChild(this.lastChild),this._container&&this._container.updateStyles({margin:"0",padding:"0"}),!0)}},{key:"sliderEligible_",value:function(t,e,i){return!i&&(DOMAIN_TO_SLIDER_SUPPORT[t]&&DOMAIN_TO_SLIDER_SUPPORT[t]&e.attributes.supported_features&&e.attributes.state_card_mode&&"no-slider"!==e.attributes.state_card_mode)}},{key:"inputChanged",value:function(t,e,i){if(i&&t&&this._isAttached){var a=window.hassUtil.computeDomain(i),n=window.customUI.maybeChangeObject(this,i,e,!0);if(!this.maybeHideEntity(n))if(this.applyThemes(t,n),e||"badges"!==n.attributes.state_card_mode){this.cleanBadgeStyle();var s={hass:t,stateObj:n,inDialog:e},r=window.hassUtil.stateCardType(t,i),o=void 0,l=n.attributes.state_card_custom_ui_secondary;"light"===a&&this.sliderEligible_(a,n,e)?(Object.assign(s,{controlElement:"ha-entity-toggle",serviceMin:"turn_off",serviceMax:"turn_on",valueName:"brightness",domain:a}),o="state-card-with-slider"):"cover"===a&&this.sliderEligible_(a,n,e)?(Object.assign(s,{controlElement:"ha-cover-controls",max:100,serviceMin:"close_cover",serviceMax:"set_cover_position",setValueName:"position",valueName:"current_position",nameOn:"open",domain:a}),o="state-card-with-slider"):"climate"===a&&this.sliderEligible_(a,n,e)?(Object.assign(s,{controlElement:"ha-climate-state",min:n.attributes.min_temp||-100,max:n.attributes.max_temp||200,serviceMin:"set_temperature",serviceMax:"set_temperature",valueName:"temperature",nameOn:"",domain:a}),o="state-card-with-slider"):void 0!==TYPE_TO_CONTROL[r]?(s.controlElement=TYPE_TO_CONTROL[r],o="state-card-without-slider"):n.attributes.show_last_changed&&!SHOW_LAST_CHANGED_BLACKLISTED_CARDS.includes(r)&&(s.inDialog=!0),"unavailable"===n.state&&(s.controlElement=""),window.hassUtil.dynamicContentUpdater(this,(l||o||"STATE-CARD-"+r).toUpperCase(),s)}else this.badgeMode(t,n,a)}}}],[{key:"is",get:function(){return"state-card-custom-ui"}},{key:"properties",get:function(){return{hass:Object,inDialog:{type:Boolean,value:!1},stateObj:Object}}},{key:"observers",get:function(){return["inputChanged(hass, inDialog, stateObj)"]}}]),e}();customElements.define(StateCardCustomUi.is,StateCardCustomUi);</script></div>